<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dialog</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
  <h1>Do you want to save the document?</h1>
  <button id="confirmSave">Yes, Save</button>
  <p id="status">Loading...</p>
  <script>
    // Ensure Office.js is loaded
    Office.onReady()
      .then(() => {
        // Office.js is ready
        document.getElementById("status").innerText = "Ready";

        // Attach the click event
        document.getElementById("confirmSave").onclick = function () {
          debugger; // Debugger will stop here in the browser
          // Send a message to the parent task pane
          Office.context.ui.messageParent("closeDialogAndSave");
        };
      })
      .catch((error) => {
        // Handle errors
        console.error("Office.js failed to initialize:", error);
        document.getElementById("status").innerText = "Error initializing Office.js. Please reload.";
      });
  </script>
</body>
</html>
